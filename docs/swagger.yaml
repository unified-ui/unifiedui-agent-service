basePath: /
definitions:
  dto.AddLogsRequest:
    properties:
      logs:
        items: {}
        minItems: 1
        type: array
    required:
    - logs
    type: object
  dto.AddNodesRequest:
    properties:
      nodes:
        items:
          $ref: '#/definitions/dto.TraceNodeRequest'
        minItems: 1
        type: array
    required:
    - nodes
    type: object
  dto.CreateTraceRequest:
    properties:
      applicationId:
        description: Context fields - EITHER (applicationId + conversationId) OR autonomousAgentId
        type: string
      autonomousAgentId:
        type: string
      conversationId:
        type: string
      id:
        description: ID is optional; if not provided, one will be generated.
        type: string
      logs:
        description: Initial logs (optional).
        items: {}
        type: array
      nodes:
        description: Initial nodes (optional).
        items:
          $ref: '#/definitions/dto.TraceNodeRequest'
        type: array
      referenceId:
        description: Reference fields for external system linkage.
        type: string
      referenceMetadata:
        additionalProperties: true
        type: object
      referenceName:
        type: string
    type: object
  dto.CreateTraceResponse:
    properties:
      id:
        type: string
    type: object
  dto.ErrorResponse:
    properties:
      code:
        type: string
      details:
        type: string
      message:
        type: string
    type: object
  dto.ListTracesResponse:
    properties:
      traces:
        items:
          $ref: '#/definitions/dto.TraceResponse'
        type: array
    type: object
  dto.NodeDataIORequest:
    properties:
      extraData:
        additionalProperties: true
        type: object
      metadata:
        additionalProperties: true
        type: object
      text:
        type: string
    type: object
  dto.NodeDataIOResponse:
    properties:
      extraData:
        additionalProperties: true
        type: object
      metadata:
        additionalProperties: true
        type: object
      text:
        type: string
    type: object
  dto.NodeDataRequest:
    properties:
      input:
        $ref: '#/definitions/dto.NodeDataIORequest'
      output:
        $ref: '#/definitions/dto.NodeDataIORequest'
    type: object
  dto.NodeDataResponse:
    properties:
      input:
        $ref: '#/definitions/dto.NodeDataIOResponse'
      output:
        $ref: '#/definitions/dto.NodeDataIOResponse'
    type: object
  dto.RefreshTraceRequest:
    properties:
      logs:
        description: Logs to set.
        items: {}
        type: array
      nodes:
        description: Nodes to set.
        items:
          $ref: '#/definitions/dto.TraceNodeRequest'
        type: array
      referenceId:
        description: Reference fields for external system linkage.
        type: string
      referenceMetadata:
        additionalProperties: true
        type: object
      referenceName:
        type: string
    type: object
  dto.TraceNodeRequest:
    properties:
      data:
        $ref: '#/definitions/dto.NodeDataRequest'
      duration:
        type: number
      endAt:
        type: string
      id:
        type: string
      logs:
        items: {}
        type: array
      metadata:
        additionalProperties: true
        type: object
      name:
        type: string
      nodes:
        description: Sub-nodes
        items:
          $ref: '#/definitions/dto.TraceNodeRequest'
        type: array
      referenceId:
        type: string
      startAt:
        type: string
      status:
        type: string
      type:
        type: string
    required:
    - id
    - name
    - status
    - type
    type: object
  dto.TraceNodeResponse:
    properties:
      createdAt:
        type: string
      createdBy:
        type: string
      data:
        $ref: '#/definitions/dto.NodeDataResponse'
      duration:
        type: number
      endAt:
        type: string
      id:
        type: string
      logs:
        items: {}
        type: array
      metadata:
        additionalProperties: true
        type: object
      name:
        type: string
      nodes:
        items:
          $ref: '#/definitions/dto.TraceNodeResponse'
        type: array
      referenceId:
        type: string
      startAt:
        type: string
      status:
        type: string
      type:
        type: string
      updatedAt:
        type: string
      updatedBy:
        type: string
    type: object
  dto.TraceResponse:
    properties:
      applicationId:
        type: string
      autonomousAgentId:
        type: string
      contextType:
        type: string
      conversationId:
        type: string
      createdAt:
        type: string
      createdBy:
        type: string
      id:
        type: string
      logs:
        items: {}
        type: array
      nodes:
        items:
          $ref: '#/definitions/dto.TraceNodeResponse'
        type: array
      referenceId:
        type: string
      referenceMetadata:
        additionalProperties: true
        type: object
      referenceName:
        type: string
      tenantId:
        type: string
      updatedAt:
        type: string
      updatedBy:
        type: string
    type: object
  handlers.GetMessagesResponse:
    properties:
      messages:
        items:
          $ref: '#/definitions/handlers.MessageResponse'
        type: array
    type: object
  handlers.HealthResponse:
    properties:
      components:
        additionalProperties:
          type: string
        type: object
      status:
        type: string
    type: object
  handlers.InvokeConfig:
    properties:
      chatHistoryMessageCount:
        type: integer
    type: object
  handlers.MessageContent:
    properties:
      attachments:
        items:
          type: string
        type: array
      content:
        maxLength: 32000
        minLength: 1
        type: string
    required:
    - content
    type: object
  handlers.MessageResponse:
    properties:
      applicationId:
        type: string
      content:
        type: string
      conversationId:
        type: string
      createdAt:
        type: string
      errorMessage:
        type: string
      id:
        type: string
      metadata:
        $ref: '#/definitions/models.AssistantMetadata'
      status:
        $ref: '#/definitions/models.MessageStatus'
      statusTraces:
        items:
          $ref: '#/definitions/models.StatusTrace'
        type: array
      type:
        $ref: '#/definitions/models.MessageType'
      updatedAt:
        type: string
      userId:
        type: string
      userMessageId:
        type: string
    type: object
  handlers.SendMessageRequest:
    properties:
      applicationId:
        type: string
      conversationId:
        type: string
      extConversationId:
        type: string
      invokeConfig:
        $ref: '#/definitions/handlers.InvokeConfig'
      message:
        $ref: '#/definitions/handlers.MessageContent'
    required:
    - applicationId
    - message
    type: object
  handlers.SendMessageResponse:
    properties:
      assistantMessageId:
        type: string
      conversationId:
        type: string
      userMessageId:
        type: string
    type: object
  models.AssistantMetadata:
    properties:
      agentType:
        type: string
      executionId:
        type: string
      latencyMs:
        type: integer
      model:
        type: string
      tokensInput:
        type: integer
      tokensOutput:
        type: integer
    type: object
  models.MessageStatus:
    enum:
    - pending
    - success
    - failed
    type: string
    x-enum-varnames:
    - MessageStatusPending
    - MessageStatusSuccess
    - MessageStatusFailed
  models.MessageType:
    enum:
    - user
    - assistant
    type: string
    x-enum-varnames:
    - MessageTypeUser
    - MessageTypeAssistant
  models.StatusTrace:
    properties:
      content:
        type: string
      data:
        additionalProperties: true
        type: object
      name:
        type: string
      timestamp:
        type: string
      type:
        type: string
    type: object
host: localhost:8085
info:
  contact:
    email: support@unifiedui.io
    name: API Support
    url: https://github.com/unifiedui/agent-service
  description: Unified abstraction layer for heterogeneous AI agent backends (N8N,
    Microsoft Foundry, Copilot, LangChain)
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: http://swagger.io/terms/
  title: UnifiedUI Chat Service API
  version: "1.0"
paths:
  /api/v1/agent-service/health:
    get:
      description: Returns the overall health status and component statuses
      produces:
      - application/json
      responses:
        "200":
          description: Service healthy
          schema:
            $ref: '#/definitions/handlers.HealthResponse'
        "503":
          description: Service unhealthy
          schema:
            $ref: '#/definitions/handlers.HealthResponse'
      summary: Health check
      tags:
      - Health
  /api/v1/agent-service/live:
    get:
      description: Returns 200 if the service is alive
      produces:
      - application/json
      responses:
        "200":
          description: Service alive
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Liveness check
      tags:
      - Health
  /api/v1/agent-service/ready:
    get:
      description: Returns 200 if the service is ready to accept traffic
      produces:
      - application/json
      responses:
        "200":
          description: Service ready
          schema:
            additionalProperties:
              type: string
            type: object
        "503":
          description: Service not ready
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Readiness check
      tags:
      - Health
  /api/v1/agent-service/tenants/{tenantId}/autonomous-agents/{agentId}/traces:
    get:
      consumes:
      - application/json
      description: Retrieves the trace for a specific autonomous agent
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Autonomous Agent ID
        in: path
        name: agentId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.TraceResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Trace not found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get trace for an autonomous agent
      tags:
      - Traces
    put:
      consumes:
      - application/json
      description: Replaces the trace for a specific autonomous agent completely
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Autonomous Agent ID
        in: path
        name: agentId
        required: true
        type: string
      - description: New trace data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.RefreshTraceRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.TraceResponse'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Trace not found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Refresh trace for an autonomous agent
      tags:
      - Traces
  /api/v1/agent-service/tenants/{tenantId}/autonomous-agents/traces:
    get:
      consumes:
      - application/json
      description: Retrieves a list of traces for autonomous agents with pagination
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Filter by autonomous agent ID
        in: query
        name: autonomousAgentId
        type: string
      - description: 'Maximum number of results (default: 20, max: 100)'
        in: query
        name: limit
        type: integer
      - description: Number of results to skip
        in: query
        name: skip
        type: integer
      - description: 'Sort order: asc or desc (default: desc)'
        in: query
        name: order
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.ListTracesResponse'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List traces for autonomous agents
      tags:
      - Traces
  /api/v1/agent-service/tenants/{tenantId}/conversation/messages:
    get:
      consumes:
      - application/json
      description: Retrieves messages for a conversation with pagination (descending
        order by createdAt)
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Conversation ID
        in: query
        name: conversationId
        required: true
        type: string
      - default: 25
        description: Maximum number of messages
        in: query
        maximum: 100
        minimum: 1
        name: limit
        type: integer
      - default: 0
        description: Offset for pagination
        in: query
        minimum: 0
        name: skip
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.GetMessagesResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get messages
      tags:
      - Messages
    post:
      consumes:
      - application/json
      description: Sends a message to an AI agent and returns the response via SSE
        streaming
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Microsoft Foundry API Key (required for Foundry agents)
        in: header
        name: X-Microsoft-Foundry-API-Key
        type: string
      - description: Message content with applicationId
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.SendMessageRequest'
      produces:
      - text/event-stream
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.SendMessageResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Send a message
      tags:
      - Messages
  /api/v1/agent-service/tenants/{tenantId}/conversations/{conversationId}/traces:
    get:
      consumes:
      - application/json
      description: Retrieves the trace for a specific conversation
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Conversation ID
        in: path
        name: conversationId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.TraceResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Trace not found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get trace for a conversation
      tags:
      - Traces
    put:
      consumes:
      - application/json
      description: Replaces the trace for a specific conversation completely
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Conversation ID
        in: path
        name: conversationId
        required: true
        type: string
      - description: New trace data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.RefreshTraceRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.TraceResponse'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Trace not found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Refresh trace for a conversation
      tags:
      - Traces
  /api/v1/agent-service/tenants/{tenantId}/traces:
    post:
      consumes:
      - application/json
      description: Creates a new trace for a conversation or autonomous agent
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Trace creation request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.CreateTraceRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/dto.CreateTraceResponse'
        "400":
          description: Bad request - validation error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Application, Conversation, or AutonomousAgent not found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create a new trace
      tags:
      - Traces
  /api/v1/agent-service/tenants/{tenantId}/traces/{traceId}:
    delete:
      consumes:
      - application/json
      description: Deletes a specific trace by its ID
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Trace ID
        in: path
        name: traceId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Trace not found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete a trace
      tags:
      - Traces
    get:
      consumes:
      - application/json
      description: Retrieves a specific trace by its ID
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Trace ID
        in: path
        name: traceId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/dto.TraceResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Trace not found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get a trace by ID
      tags:
      - Traces
  /api/v1/agent-service/tenants/{tenantId}/traces/{traceId}/logs:
    post:
      consumes:
      - application/json
      description: Appends logs to an existing trace
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Trace ID
        in: path
        name: traceId
        required: true
        type: string
      - description: Logs to add
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.AddLogsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Success
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Trace not found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Add logs to a trace
      tags:
      - Traces
  /api/v1/agent-service/tenants/{tenantId}/traces/{traceId}/nodes:
    post:
      consumes:
      - application/json
      description: Appends nodes to an existing trace
      parameters:
      - description: Tenant ID
        in: path
        name: tenantId
        required: true
        type: string
      - description: Trace ID
        in: path
        name: traceId
        required: true
        type: string
      - description: Nodes to add
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/dto.AddNodesRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Success
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "404":
          description: Trace not found
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/dto.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Add nodes to a trace
      tags:
      - Traces
schemes:
- http
- https
securityDefinitions:
  BearerAuth:
    description: Bearer token authentication (MSAL)
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
